<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog logicalFilePath="src/main/resources/db/changelog/changes/2025-09-26/http_outbound_call.xml" xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-latest.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">
    <changeSet author="andual (generated)" id="1758923583408-1">
        <createTable tableName="http_outbound_call">
            <column autoIncrement="true" name="id" startWith="674" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="http_outbound_call_pkey"/>
            </column>
            <column defaultValueComputed="now()" name="created_at" type="TIMESTAMP WITH TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="finished_at" type="TIMESTAMP WITH TIME ZONE"/>
            <column name="duration_ms" type="INTEGER"/>
            <column name="service_name" type="VARCHAR(150)"/>
            <column name="environment" type="VARCHAR(50)"/>
            <column name="app_version" type="VARCHAR(100)"/>
            <column name="correlation_id" type="VARCHAR(128)"/>
            <column name="trace_id" type="VARCHAR(128)"/>
            <column name="span_id" type="VARCHAR(128)"/>
            <column name="origin_method" type="VARCHAR(10)"/>
            <column name="origin_path" type="TEXT"/>
            <column name="origin_ip" type="INET"/>
            <column name="user_id" type="VARCHAR(100)"/>
            <column name="target_method" type="VARCHAR(10)">
                <constraints nullable="false"/>
            </column>
            <column name="target_url" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="target_host" type="TEXT"/>
            <column name="target_path" type="TEXT"/>
            <column name="target_query" type="TEXT"/>
            <column name="request_headers" type="JSONB"/>
            <column name="request_body" type="TEXT"/>
            <column name="request_body_size" type="INTEGER"/>
            <column defaultValueBoolean="false" name="request_truncated" type="BOOLEAN"/>
            <column name="response_status" type="INTEGER"/>
            <column name="response_headers" type="JSONB"/>
            <column name="response_body" type="TEXT"/>
            <column name="response_body_size" type="INTEGER"/>
            <column defaultValueBoolean="false" name="response_truncated" type="BOOLEAN"/>
            <column name="error_message" type="TEXT"/>
            <column name="error_stacktrace" type="TEXT"/>
            <column name="meta" type="JSONB"/>
        </createTable>
    </changeSet>
    <changeSet author="andual (generated)" id="1758923583408-2">
        <createIndex indexName="http_outbound_call_created_at_idx" tableName="http_outbound_call" using="btree">
            <column descending="true" name="created_at"/>
        </createIndex>
    </changeSet>
    <changeSet author="andual (generated)" id="1758923583408-3">
        <createIndex indexName="http_outbound_call_service_name_created_at_idx" tableName="http_outbound_call" using="btree">
            <column name="service_name"/>
            <column descending="true" name="created_at"/>
        </createIndex>
    </changeSet>
    <changeSet author="andual (generated)" id="1758923583408-4">
        <createIndex indexName="http_outbound_call_response_status_idx" tableName="http_outbound_call" using="btree">
            <column name="response_status"/>
        </createIndex>
    </changeSet>
    <changeSet author="andual (generated)" id="1758923583408-5">
        <createIndex indexName="http_outbound_call_correlation_id_idx" tableName="http_outbound_call" using="btree">
            <column name="correlation_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="andual (generated)" id="1758923583408-6">
        <createIndex indexName="http_outbound_call_target_host_idx" tableName="http_outbound_call" using="btree">
            <column name="target_host"/>
        </createIndex>
    </changeSet>
</databaseChangeLog>
